<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>ë§ˆì´í˜ì´ì§€ | reZero</title>

    <!-- ê³µí†µ CSS -->
    <link rel="stylesheet" href="/css/style.css"/>
    <!-- ë§ˆì´í˜ì´ì§€ CSS -->
    <link rel="stylesheet" href="css/mypage.css"/>

    <style>
        /* â­ ì±„íŒ… ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .chat-btn {
            margin-top: 10px;
            background: #5ca77f;
            color: white;
            padding: 10px 18px;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            display: inline-block;
            border: none;
        }
        .chat-btn:hover {
            background: #4d8f6a;
        }
    </style>
</head>

<body>

<!-- â­ í—¤ë” -->
<div id="header-placeholder"></div>

<main class="mypage-container">

    <!-- â­ í”„ë¡œí•„ ì˜ì—­ -->
    <section class="profile-header">
        <div class="profile-left">
            <img id="profileImage" src="/images/default-profile.png" alt="í”„ë¡œí•„" class="profile-img"/>
        </div>

        <div class="profile-center">
            <h2 id="userName">ì‚¬ìš©ì ì´ë¦„</h2>

            <div class="user-subinfo">
                <span id="userRole">ROLE_USER</span> Â·
                <span id="userRegion">-</span> Â·
                <span id="userBirth">-</span>
            </div>

            <!-- â­â­ ì—¬ê¸°ì— ì±„íŒ… ë²„íŠ¼ ì¶”ê°€ â­â­ -->
            <button id="chatBtn" class="chat-btn">ğŸ’¬ ì±„íŒ…í•˜ê¸°</button>
        </div>
    </section>

    <!-- â­ ì´ë²ˆ ì£¼ ë¯¸ì…˜ ì¸ì¦ í˜„í™© -->
    <section class="mission-stamp-board">
        <h3>ì´ë²ˆ ì£¼ ë¯¸ì…˜ ì¸ì¦ í˜„í™©</h3>
        <div id="stampGrid" class="stamp-grid"></div>
    </section>

    <!-- â­ íƒ­ ë©”ë‰´ -->
    <nav class="mypage-tabs">
        <button data-tab="scrap" class="active">ìŠ¤í¬ë©</button>
        <button data-tab="like">ì¢‹ì•„ìš”</button>
        <button data-tab="community">ë¯¸ì…˜ ì»¤ë®¤ë‹ˆí‹°</button>
        <button data-tab="edit">ë‚´ ì •ë³´ ìˆ˜ì •</button>
    </nav>

    <!-- â­ íƒ­ ë‚´ìš© -->
    <section id="tab-content" class="tab-content">
        <div id="scrap" class="tab-pane active"></div>
        <div id="like" class="tab-pane"></div>
        <div id="community" class="tab-pane"></div>

        <div id="edit" class="tab-pane">
            <form id="profileEditForm" enctype="multipart/form-data">

                <label>ì•„ì´ë””</label>
                <input type="text" id="editUserId" readonly />

                <label>í”„ë¡œí•„ ì´ë¯¸ì§€</label>
                <input type="file" id="newProfileImage" accept="image/*"/>

                <label>ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</label>
                <input type="password" id="editPassword" placeholder="ìƒˆ ë¹„ë°€ë²ˆí˜¸ (ì„ íƒ)"/>

                <label>ì´ë¦„</label>
                <input type="text" id="editName" placeholder="ì´ë¦„"/>

                <label>ì§€ì—­</label>
                <input type="text" id="editRegion" placeholder="ì§€ì—­"/>

                <label>ìƒë…„ì›”ì¼</label>
                <input type="date" id="editBirth"/>

                <div class="form-actions">
                    <button type="submit" class="btn-save">ì €ì¥í•˜ê¸°</button>
                    <button type="button" class="btn-delete" onclick="deleteAccount()">íšŒì› íƒˆí‡´</button>
                </div>
            </form>
        </div>
    </section>

</main>

<!-- â­ í‘¸í„° -->
<div id="footer-placeholder"></div>

<!-- WebSocket -->
<script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>

<!-- ê³µí†µ JS -->
<script src="/js/common.js"></script>
<!-- ë§ˆì´í˜ì´ì§€ JS -->
<script src="js/mypage.js"></script>

<script>
    /* â­ ì±„íŒ… ë²„íŠ¼ ë™ì‘ */
    document.addEventListener("DOMContentLoaded", () => {
        const btn = document.getElementById("chatBtn");

        btn.addEventListener("click", () => {
            const userId = localStorage.getItem("userId");
            if (!userId) {
                alert("ë¡œê·¸ì¸ í›„ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.");
                return;
            }
            // chat.htmlë¡œ ì´ë™
            window.location.href = `/chat.html?user=${userId}`;
        });
    });
</script>

</body>
</html>
